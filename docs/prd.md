Nano-Banana AI 绘图应用 产品需求文档 (PRD)
1. 目标和背景 (Goals and Background Context)
目标 (Goals)
为用户提供一个直观、流畅的界面来使用 nano-banana 模型。
确保应用在PC和移动Web端都有一致的高品质体验。
建立一个基于“次数”的计费系统，让用户可以灵活使用服务。
在3个月内发布MVP版本，并获取首批100名活跃用户。
背景 (Background Context)
本项目旨在解决非技术用户难以直接使用 nano-banana 模型，以及现有工具在跨平台体验上普遍不佳的问题。通过提供一个统一管理API密钥、用户通过购买次数使用的平台，我们降低了用户的使用门槛，并创建了清晰的商业模式。这个PRD将详细定义实现这一愿景所需的具体功能。
变更日志 (Change Log)
日期
版本
描述
作者
2025-09-26
1.0
初始草稿
John (PM)

2. 需求 (Requirements)
功能性需求 (Functional)
(FR1) 用户能够使用电子邮箱和密码注册账户及登录。
(FR2) 系统需要为每个用户账户记录和管理其拥有的“生成次数”。
(FR3) 每成功进行一次图片生成，系统将从用户账户中扣除相应的“生成次数”。
(FR4) 必须提供一个后台功能，允许管理员（开发者）为指定用户手动增加“生成次数”。
(FR5) “文生图”功能：用户可以输入文本提示词，选择模型（如 nano-banana, nano-banana-hd）和图片尺寸比例进行生成。
(FR6) “图生图”功能：用户可以输入文本提示词，并同时上传一张或多张图片作为参考进行生成。
(FR7) 用户拥有一个个人画廊，可以查看、管理自己所有历史生成的图片。
(FR8) 用户可以从画廊或生成结果页面下载高清图片。
非功能性需求 (Non-Functional)
(NFR1) 应用界面必须是响应式的，在PC桌面和移动Web浏览器上都能提供优秀、一致的用户体验。
(NFR2) 应用交互必须流畅，加载时间和响应时间应尽可能短，以提供高质量的用户体验。
(NFR3) 系统必须安全地存储和管理唯一的平台API密钥，绝不能暴露在前端。
(NFR4) “生成次数”的计算和扣除必须准确无误。
(NFR5) 技术栈应遵循：前端Vue.js，后端Flask，数据库SQLite。
3. 用户界面设计目标 (User Interface Design Goals)
整体UX愿景 (Overall UX Vision)
我们的目标是创造一种“即时创意”的体验。界面应极简、直观，让用户能将注意力完全集中在他们的创意上，而不是工具本身。从输入第一个字到看到最终图像的整个过程都应该是无缝、流畅且富有启发性的。
关键交互范式 (Key Interaction Paradigms)
提示词优先： 以一个清晰、引人注目的文本输入框为核心交互点。
实时反馈： 用户的任何操作（如选择模型、尺寸）都应立即在界面上得到视觉反馈。生成过程中必须有明确的进度指示。
画廊为中心： 用户的作品是核心资产。画廊应易于访问、浏览和管理。
核心屏幕和视图 (Core Screens and Views)
注册/登录页
主生成页 (一个统一的界面，支持文生图和图生图模式切换)
个人画廊页 (展示历史作品)
账户/次数管理页 (查看剩余次数，为后续购买功能预留位置)
可访问性 (Accessibility)
推荐标准: WCAG AA。这是一个行业标准，能确保我们的应用可供更广泛的用户（包括残障人士）使用。
品牌 (Branding)
待定 (TBD)。初步设想是简洁、现代且富有创意的风格。
目标设备和平台 (Target Device and Platforms)
Web 响应式。应用必须在主流的PC桌面浏览器和移动端浏览器上都能无缝工作。
4. 技术假设 (Technical Assumptions)
仓库结构 (Repository Structure)
推荐: Monorepo (单一代码仓库)。
服务架构 (Service Architecture)
推荐: Monolith (单体架构)。
测试要求 (Testing Requirements)
推荐: 单元测试 + 集成测试 (Unit + Integration)。
其他技术假设和要求 (Additional Technical Assumptions and Requests)
核心技术栈 (用户已指定): 前端: Vue.js, 后端: Flask, 数据库: SQLite。
部署目标 (推荐): PaaS平台（如Render, Vercel, Heroku）或单个VPS。
5. 史诗列表 (Epic List)
史诗 1: 项目基础与核心用户系统 (Foundation & Core User System)
目标: 建立项目的基础设施、数据库，并实现完整的用户注册、登录及后台次数管理功能。
史诗 2: 核心AI绘图体验 (Core AI Generation Experience)
目标: 构建核心的“文生图”和“图生图”用户界面和后端逻辑，并实现生成操作与用户次数的扣减绑定。
史诗 3: 用户画廊与作品管理 (User Gallery & Asset Management)
目标: 为用户提供一个个人画廊，让他们可以浏览、管理和下载自己创作的图片。
6. 史诗详情 (Epic Details)
史诗 1: 项目基础与核心用户系统
史诗目标: 这个史诗旨在搭建应用的“骨架”。完成时，我们将拥有一个可运行、可部署的Web应用，包含正常工作的数据库、完整的用户认证系统（注册、登录），以及管理用户次数的基础后台逻辑。这将为未来所有功能的开发铺平道路。
故事 1.1: 项目初始化与环境搭建
作为 开发者, 我想要 初始化一个包含Vue前端和Flask后端的Monorepo项目, 以便 我有一个标准化的、可运行的开发环境。
验收标准:
项目代码仓库已创建，包含 apps/frontend 和 apps/backend 目录。
Vue和Flask的核心依赖已安装。
运行一个命令 (如 npm run dev) 可以同时启动前端和后端开发服务器。
在浏览器中可以访问前端的“Hello World”欢迎页面。
故事 1.2: 数据库与用户模型设置
作为 开发者, 我想要 配置SQLite数据库并创建用户模型, 以便 存储用户信息和他们的“生成次数”。
验收标准:
SQLite数据库文件已在后端项目中正确配置和初始化。
用户 (User) 数据表已创建，包含字段：ID, 邮箱, 密码哈希, 生成次数 (默认为0)。
后端包含一个可以与该数据表交互的用户模型。
故事 1.3: 用户注册功能
作为 新用户, 我想要 使用邮箱和密码注册一个新账户, 以便 我可以使用应用的功能。
验收标准:
前端提供一个包含邮箱、密码输入框和提交按钮的注册表单。
后端提供一个 /api/register 接口。
成功提交后，数据库中会创建一个新用户记录。
密码必须经过哈希处理后才能存入数据库。
如果邮箱已被注册，应向用户显示错误提示。
故事 1.4: 用户登录功能
作为 已注册用户, 我想要 使用我的邮箱和密码登录, 以便 系统可以识别我的身份并访问我的账户。
验收标准:
前端提供一个登录表单。
后端提供一个 /api/login 接口，验证用户凭据。
登录成功后，后端返回一个身份令牌 (如JWT)。
前端能够存储这个令牌，并用它来进行后续的认证请求。
登录失败会显示明确的错误信息。
故事 1.5: (后台) 手动添加用户次数
作为 管理员（开发者）, 我想要 一个简单的方式来为指定用户手动增加“生成次数”, 以便 在MVP阶段进行运营和测试。
验收标准:
后端提供一个受保护的管理接口或脚本。
通过该接口，可以根据用户邮箱查询用户，并为其增加指定数量的“生成次数”。
用户的“生成次数”在数据库中得到正确更新。
史诗 2: 核心AI绘图体验
史诗目标: 这个史诗将交付我们应用的核心价值。完成时，已登录的用户将能够使用他们的“生成次数”，通过一个统一、直观的界面，完成“文生图”和“图生图”操作。整个过程将是无缝的，并为用户提供清晰的状态反馈。
故事 2.1: 应用主页布局与认证保护
作为 已登录用户, 我想要 访问一个受保护的应用主页, 以便 我可以看到我的账户信息并准备开始创作。
验收标准:
未登录用户访问主应用页面时，会被重定向到登录页。
已登录用户可以成功访问主应用页面 (/app)。
页面的顶部导航栏能显示当前用户的邮箱和剩余的“生成次数”。
主页面有一个用于放置生成工具的核心内容区域。
故事 2.2: “文生图”前端界面组件
作为 用户, 我想要 一个包含所有必要选项的“文生图”表单, 以便 我可以精确地描述我想要的图片。
验收标准:
界面中有一个用于输入文本提示词的大输入框。
提供一个下拉菜单或选项，用于选择模型（nano-banana, nano-banana-hd）。
提供一组按钮或选项，用于选择图片尺寸比例（如 4x3, 16x9 等）。
有一个清晰的“生成”按钮。
此界面在桌面和移动设备上布局合理。
故事 2.3: “文生图”后端接口
作为 开发者, 我想要 创建一个安全的后端接口来处理“文生图”请求, 以便 隔离API密钥并管理用户次数。
验收标准:
后端提供一个受保护的 /api/generate/text-to-image 接口，只有登录用户才能访问。
该接口接收来自前端的提示词、模型和尺寸参数。
在调用外部API前，接口会检查用户是否有足够的“生成次数”（至少1次）。
接口使用平台方的API密钥安全地调用 api.openai-hk.com 的生成接口。
成功生成图片后，用户的“生成次数”会减1。
接口将生成的图片URL或结果返回给前端。
故事 2.4: 端到端连接“文生图”功能
作为 用户, 我想要 点击“生成”按钮后能看到AI生成的图片, 以便 完成一次完整的创作流程。
验收标准:
在前端点击“生成”按钮会调用后端的 /api/generate/text-to-image 接口。
在等待图片生成时，界面会显示一个清晰的加载或处理中状态。
成功后，生成的图片会显示在界面上。
导航栏中的“生成次数”会自动刷新并显示新余额。
如果后端返回错误，前端会向用户显示友好的错误提示。
故事 2.5: “图生图”前端界面组件
作为 用户, 我想要 在主生成界面上传一张或多张参考图片, 以便 我可以使用“图生图”功能。
验收标准:
在“文生图”界面的基础上，增加一个图片上传区域。
用户可以选择并上传多个图片文件。
上传后，界面会显示已选图片的缩略图。
用户可以移除已上传的图片。
故事 2.6: “图生图”后端接口
作为 开发者, 我想要 创建一个能处理图片上传的后端接口, 以便 支持“图生图”功能。
验收标准:
后端提供一个受保护的 /api/generate/image-to-image 接口。
接口能接收文本提示词和多张图片文件。
接口会检查用户是否有足够的“生成次数”。
接口安全地调用 api.openai-hk.com 的 /v1/images/edits 接口。
成功后，用户的“生成次数”减1，并将结果返回给前端。
故事 2.7: 端到端连接“图生图”功能
作为 用户, 我想要 在上传图片和输入提示词后，能生成一张融合了两者特点的新图片, 以便 实现更复杂的创意。
验收标准:
在上传了图片后点击“生成”按钮，会调用后端的 /api/generate/image-to-image 接口。
完整的加载、图片显示、次数扣减和错误处理流程能正常工作。
史诗 3: 用户画廊与作品管理
史诗目标: 这个史诗旨在完成核心用户体验的闭环，为用户提供一个专属空间来回顾和管理他们的创意成果。完成时，用户将拥有一个个人画廊，使他们生成的图片能够被持久化保存和使用，从而将我们的应用从一个单次的生成工具，提升为一个有长期价值的创作平台。
故事 3.1: (后端) 保存生成结果
作为 系统, 我想要 在每次成功生成图片后，将结果（包括图片URL、提示词等）与用户ID关联并存入数据库, 以便 用户日后可以回顾他们的作品。
验收标准:
创建一个 Creations (作品) 数据表，包含字段：ID, 用户ID, 图片URL, 提示词, 创建日期等。
在图片生成成功后（无论是文生图还是图生图），一条新的作品记录会被保存到该表中。
该记录必须与当前登录的用户正确关联。
故事 3.2: (后端) 创建画廊数据接口
作为 开发者, 我想要 创建一个后端接口来获取当前用户的历史作品列表, 以便 在前端画廊页面中展示它们。
验收标准:
后端提供一个受保护的 /api/gallery 接口。
该接口返回一个属于当前认证用户的所有作品列表。
返回的数据列表应按创建日期降序排列（最新的在前）。
列表中的每个项目都应包含图片URL、提示词和创建日期等信息。
故事 3.3: (前端) 构建画廊页面基本界面
作为 用户, 我想要 一个“画廊”页面来集中查看我所有的作品, 以便 我可以欣赏和管理我的创作。
验收标准:
在应用的主导航中增加一个“画廊”链接。
画廊页面采用响应式的网格布局来展示图片缩略图。
当正在加载图片时，页面会显示一个加载指示器。
如果用户没有任何作品，页面会显示一个友好的空状态提示（例如，“您还没有任何作品，快去创作吧！”）。
故事 3.4: 端到端连接画廊功能
作为 用户, 我想要 点击“画廊”链接后能看到我所有生成的图片, 以便 我能立即访问我的作品集。
验收标准:
进入画廊页面时，前端会自动调用后端的 /api/gallery 接口。
接口返回的图片数据被正确地渲染到页面的网格布局中。
（可选）支持简单的分页或无限滚动，以处理大量图片。
故事 3.5: 图片详情查看与下载
作为 用户, 我想要 点击画廊中的任意一张图片来查看大图并下载它, 以便 我可以将作品保存到本地使用。
验收标准:
点击画廊中的缩略图，会弹出一个模态窗口或跳转到新页面，展示该图片的高清版本。
在详情视图中，会同时显示生成该图片时使用的提示词。
提供一个清晰的“下载”按钮。
点击“下载”按钮，可以将原始图片文件保存到用户的设备上。
